sd(results_hoc[[paste(c)]][[res]][["rejection"]])),
"wald"=res,
row.names = NULL)
)
}))
return(tempo)
}))
do.call(rbind,lapply(estimators_wald,function(res){
return(data.frame(method = c("mean","se"),
tempo = c(mean(results_hoc[[paste(c)]][[res]][["rejection"]]),
sd(results_hoc[[paste(c)]][[res]][["rejection"]])),
"wald"=res,
row.names = NULL) %>%
rename(paste(c)="tempo")
)
}))
do.call(rbind,lapply(estimators_wald,function(res){
dt = data.frame(method = c("mean","se"),
"wald"=rep(res,2),
row.names = NULL)
dt[[paste(c)]] <- c(mean(results_hoc[[paste(c)]][[res]][["rejection"]]),
sd(results_hoc[[paste(c)]][[res]][["rejection"]]))
return(dt)
}))
do.call(left_join,lapply(clusters, function(c){
tempo = do.call(rbind,lapply(estimators_wald,function(res){
dt = data.frame(method = c("mean","se"),
"wald"=rep(res,2),
row.names = NULL)
dt[[paste(c)]] <- c(mean(results_hoc[[paste(c)]][[res]][["rejection"]]),
sd(results_hoc[[paste(c)]][[res]][["rejection"]]))
return(dt)
}))
return(tempo)
}))
library('tidyverse')
do.call(left_join,lapply(clusters, function(c){
tempo = do.call(rbind,lapply(estimators_wald,function(res){
dt = data.frame(method = c("mean","se"),
"wald"=rep(res,2),
row.names = NULL)
dt[[paste(c)]] <- c(mean(results_hoc[[paste(c)]][[res]][["rejection"]]),
sd(results_hoc[[paste(c)]][[res]][["rejection"]]))
return(dt)
}))
return(tempo)
}))
do.call(left_join,lapply(clusters, function(c){
tempo = do.call(rbind,lapply(estimators_wald,function(res){
dt = data.frame(method = c("mean","se"),
"wald"=rep(res,2),
row.names = NULL)
dt[[paste(c)]] <- c(mean(results_hoc[[paste(c)]][[res]][["rejection"]]),
sd(results_hoc[[paste(c)]][[res]][["rejection"]]))
return(dt)
}))
return(tempo)
}))
do.call(rbind,lapply(estimators_wald,function(res){
dt = data.frame(method = c("mean","se"),
"wald"=rep(res,2),
row.names = NULL)
dt[[paste(c)]] <- c(mean(results_hoc[[paste(c)]][[res]][["rejection"]]),
sd(results_hoc[[paste(c)]][[res]][["rejection"]]))
return(dt)
}))
return(tempo)
}), by=c('method',"wald"))
lapply(clusters, function(c){
tempo = do.call(rbind,lapply(estimators_wald,function(res){
dt = data.frame(method = c("mean","se"),
"wald"=rep(res,2),
row.names = NULL)
dt[[paste(c)]] <- c(mean(results_hoc[[paste(c)]][[res]][["rejection"]]),
sd(results_hoc[[paste(c)]][[res]][["rejection"]]))
return(dt)
}))
return(tempo)
})
do.call(full_join,lapply(clusters, function(c){
tempo = do.call(rbind,lapply(estimators_wald,function(res){
dt = data.frame(method = c("mean","se"),
"wald"=rep(res,2),
row.names = NULL)
dt[[paste(c)]] <- c(mean(results_hoc[[paste(c)]][[res]][["rejection"]]),
sd(results_hoc[[paste(c)]][[res]][["rejection"]]))
return(dt)
}))
return(tempo)
}), by=c('method',"wald"))
do.call(full_join, by=c('method',"wald"),lapply(clusters, function(c){
tempo = do.call(rbind,lapply(estimators_wald,function(res){
dt = data.frame(method = c("mean","se"),
"wald"=rep(res,2),
row.names = NULL)
dt[[paste(c)]] <- c(mean(results_hoc[[paste(c)]][[res]][["rejection"]]),
sd(results_hoc[[paste(c)]][[res]][["rejection"]]))
return(dt)
}))
return(tempo)
}))
?full_join
do.call(full_join, lapply(clusters, function(c){
tempo = do.call(rbind,lapply(estimators_wald,function(res){
dt = data.frame(method = c("mean","se"),
"wald"=rep(res,2),
row.names = NULL)
dt[[paste(c)]] <- c(mean(results_hoc[[paste(c)]][[res]][["rejection"]]),
sd(results_hoc[[paste(c)]][[res]][["rejection"]]))
return(dt)
}))
return(tempo)
}))
# Printing results_hoc
table_results_hoc = lapply(clusters, function(c){
tempo = do.call(rbind,lapply(estimators_wald,function(res){
dt = data.frame(method = c("mean","se"),
"wald"=rep(res,2),
row.names = NULL)
dt[[paste(c)]] <- c(mean(results_hoc[[paste(c)]][[res]][["rejection"]]),
sd(results_hoc[[paste(c)]][[res]][["rejection"]]))
return(dt)
}))
return(tempo)
}) %>% reduce(full_join, by=c("method","wald"))
lapply(clusters, function(c){
tempo = do.call(rbind,lapply(estimators_wald,function(res){
dt = data.frame(method = c("mean","se"),
"wald"=rep(res,2),
row.names = NULL)
dt[[paste(c)]] <- c(mean(results_hoc[[paste(c)]][[res]][["rejection"]]),
sd(results_hoc[[paste(c)]][[res]][["rejection"]]))
return(dt)
}))
return(tempo)
}) %>% reduce(full_join, by=c("method","wald"))
lapply(clusters, function(c){
tempo = do.call(rbind,lapply(estimators_wald,function(res){
dt = data.frame(method = c("mean","se"),
"wald"=rep(res,2),
row.names = NULL)
dt[[paste(c)]] <- c(mean(results_hoc[[paste(c)]][[res]][["rejection"]]),
sd(results_hoc[[paste(c)]][[res]][["rejection"]]))
return(dt)
}))
return(tempo)
}) %>% reduce(full_join, by=c("method","wald")) %>%
select(-method)
names <- c('Assume i.i.d.',' ',
'Cluster-robust','','CR3 residual correction','',
'BDM bootstrap-t','','Pairs cluster bootstrap-t','',
'Pairs CR3 bootstrap-t','',
'Residual cluster bootstrap-t','',
'Wild cluster bootstrap-t','')
print(table_results_hoc)
table_results_hoc[rep(c('ols','crve','cr3_Bt',
'ols_Bt','crve_Bt','cr3',
'resi_Bt','wild_Bt'),each=2),]
rep(c('ols','crve','cr3_Bt',
'ols_Bt','crve_Bt','cr3',
'resi_Bt','wild_Bt'),each=2)
table_results_hoc
table_results_hoc[table_results_hoc$wald == rep(c('ols','crve','cr3_Bt',
'ols_Bt','crve_Bt','cr3',
'resi_Bt','wild_Bt'),each=2),]
table_results_hoc[table_results_hoc$wald %in% rep(c('ols','crve','cr3_Bt',
'ols_Bt','crve_Bt','cr3',
'resi_Bt','wild_Bt'),each=2),]
table_results_hoc
table_results_hoc[order(table_results_hoc$wald, rep(c('ols','crve','cr3_Bt',
'ols_Bt','crve_Bt','cr3',
'resi_Bt','wild_Bt'),each=2)),]
rep(c('ols','crve','cr3_Bt',
'ols_Bt','crve_Bt','cr3',
'resi_Bt','wild_Bt'),each=2)
# Printing results_hoc
table_results_hoc = lapply(clusters, function(c){
tempo = do.call(rbind,lapply(estimators_wald,function(res){
dt = data.frame(method = c("mean","se"),
"wald"=rep(res,2),
row.names = NULL)
dt[[paste(c)]] <- c(mean(results_hoc[[paste(c)]][[res]][["rejection"]]),
sd(results_hoc[[paste(c)]][[res]][["rejection"]]))
return(dt)
}))
return(tempo)
}) %>% reduce(full_join, by=c("method","wald")) %>%
mutate(wald = as.factor(wald,
levels = rep(c('ols','crve','cr3_Bt',
'ols_Bt','crve_Bt','cr3',
'resi_Bt','wild_Bt'),each=2)))
warnings()
as.factor()
?as.factor
# Printing results_hoc
table_results_hoc = lapply(clusters, function(c){
tempo = do.call(rbind,lapply(estimators_wald,function(res){
dt = data.frame(method = c("mean","se"),
"wald"=rep(res,2),
row.names = NULL)
dt[[paste(c)]] <- c(mean(results_hoc[[paste(c)]][[res]][["rejection"]]),
sd(results_hoc[[paste(c)]][[res]][["rejection"]]))
return(dt)
}))
return(tempo)
}) %>% reduce(full_join, by=c("method","wald")) %>%
mutate(wald = factor(wald,
levels = rep(c('ols','crve','cr3_Bt',
'ols_Bt','crve_Bt','cr3',
'resi_Bt','wild_Bt'),each=2)))
# Printing results_hoc
table_results_hoc = lapply(clusters, function(c){
tempo = do.call(rbind,lapply(estimators_wald,function(res){
dt = data.frame(method = c("mean","se"),
"wald"=rep(res,2),
row.names = NULL)
dt[[paste(c)]] <- c(mean(results_hoc[[paste(c)]][[res]][["rejection"]]),
sd(results_hoc[[paste(c)]][[res]][["rejection"]]))
return(dt)
}))
return(tempo)
}) %>% reduce(full_join, by=c("method","wald"))
table_results_hoc[order(table_results_hoc$wald, c('ols','crve','cr3_Bt',
'ols_Bt','crve_Bt','cr3',
'resi_Bt','wild_Bt')),]
table_results_hoc[order(table_results_hoc$wald, rep(c('ols','crve','cr3_Bt',
'ols_Bt','crve_Bt','cr3',
'resi_Bt','wild_Bt'),each=2),]
table_results_hoc[order(table_results_hoc$wald, rep(c('ols','crve','cr3_Bt',
'ols_Bt','crve_Bt','cr3',
'resi_Bt','wild_Bt'),each=2)),]
paste0(c('ols','crve','cr3_Bt',
'ols_Bt','crve_Bt','cr3',
'resi_Bt','wild_Bt'),
c('mean','se'))
paste0(rep(c('ols','crve','cr3_Bt',
'ols_Bt','crve_Bt','cr3',
'resi_Bt','wild_Bt'),each=2),
c('mean','se'))
# Printing results_hoc
table_results_hoc = lapply(clusters, function(c){
tempo = do.call(rbind,lapply(estimators_wald,function(res){
dt = data.frame(method = c("mean","se"),
"wald"=rep(res,2),
row.names = NULL)
dt[[paste(c)]] <- c(mean(results_hoc[[paste(c)]][[res]][["rejection"]]),
sd(results_hoc[[paste(c)]][[res]][["rejection"]]))
return(dt)
}))
return(tempo)
}) %>% reduce(full_join, by=c("method","wald")) %>%
mutate(rank = factor(paste0(wald,method),
levels = paste0(rep(c('ols','crve','cr3_Bt',
'ols_Bt','crve_Bt','cr3',
'resi_Bt','wild_Bt'),each=2),
c('mean','se'))))
print(table_results_hoc)
table_results_hoc[order(table_results_hoc$wald,table_results_hoc$rank),]
levels(table_results_hoc$rank)
with(table_results_hoc, table_results_hoc[order(wald, v),])
with(table_results_hoc, table_results_hoc[order(wald, rank),])
with(table_results_hoc, table_results_hoc[order(rank, rank),])
estimators_wald = c('ols','ols_Bt','crve','crve_Bt','cr3','cr3_Bt',
'resi_Bt','wild_Bt')
# Printing results_hoc
table_results_hoc = lapply(clusters, function(c){
tempo = do.call(rbind,lapply(estimators_wald,function(res){
dt = data.frame(method = c("mean","se"),
"wald"=rep(res,2),
row.names = NULL)
dt[[paste(c)]] <- c(mean(results_hoc[[paste(c)]][[res]][["rejection"]]),
sd(results_hoc[[paste(c)]][[res]][["rejection"]]))
return(dt)
}))
return(tempo)
}) %>% reduce(full_join, by=c("method","wald")) %>%
mutate(rank = factor(paste0(wald,method),
levels = paste0(rep(c('ols','crve','cr3',
'ols_Bt','crve_Bt','cr3_Bt',
'resi_Bt','wild_Bt'),each=2),
c('mean','se'))))
print(table_results_hoc)
# Printing results_hoc
table_results_hoc = lapply(clusters, function(c){
tempo = do.call(rbind,lapply(estimators_wald,function(res){
dt = data.frame(method = c("mean","se"),
"wald"=rep(res,2),
row.names = NULL)
dt[[paste(c)]] <- c(mean(results_hoc[[paste(c)]][[res]][["rejection"]]),
sd(results_hoc[[paste(c)]][[res]][["rejection"]]))
return(dt)
}))
return(tempo)
}) %>% reduce(full_join, by=c("method","wald")) %>%
mutate(rank = order(factor(paste0(wald,method),
levels = paste0(rep(c('ols','crve','cr3',
'ols_Bt','crve_Bt','cr3_Bt',
'resi_Bt','wild_Bt'),each=2),
c('mean','se')))))
print(table_results_hoc)
# Printing results_hoc
table_results_hoc = lapply(clusters, function(c){
tempo = do.call(rbind,lapply(estimators_wald,function(res){
dt = data.frame(method = c("mean","se"),
"wald"=rep(res,2),
row.names = NULL)
dt[[paste(c)]] <- c(mean(results_hoc[[paste(c)]][[res]][["rejection"]]),
sd(results_hoc[[paste(c)]][[res]][["rejection"]]))
return(dt)
}))
return(tempo)
}) %>% reduce(full_join, by=c("method","wald")) %>%
mutate(rank = factor(paste0(wald,method),
levels = paste0(rep(c('ols','crve','cr3',
'ols_Bt','crve_Bt','cr3_Bt',
'resi_Bt','wild_Bt'),each=2),
c('mean','se'))))
with(table_results_hoc, table_results_hoc[order(rank, rank),])
hoc_tex = with(table_results_hoc, table_results_hoc[order(rank, rank),])
rownames(hoc_tex) <- names
hoc_tex
hoc_tex["names"] <- names
hoc_tex
colnames(hoc_texse)
colnames(hoc_tex)
hoc_tex %>% select(-method,-wald,-rank)
hoc_tex = with(table_results_hoc, table_results_hoc[order(rank, rank),])
hoc_tex["Method"] <- names
seq(5,30,5)
c('Method',seq(5,30,5))
hoc_tex[2:nrow(hoc_tex),c('Method',seq(5,30,5))]
write.table(hoc_tex[2:nrow(hoc_tex),c('Method',seq(5,30,5))],
file = "output/homoske_norma.tex", eol='\\\\',
sep='&',quote = F,row.names = F,
col.names = T,na="")
?round
hoc_tex = with(table_results_hoc, table_results_hoc[order(rank, rank),]) %>%
mutate_if(is.numeric, round, digits=3)
hoc_tex
hoc_tex["Method"] <- names
colnames(hoc_tex)
write.table(hoc_tex[2:nrow(hoc_tex),c('Method',seq(5,30,5))],
file = "output/homoske_norma.tex", eol='\\\\',
sep='&',quote = F,row.names = F,
col.names = T,na="")
hoc_tex[2:nrow(hoc_tex),c('Method',seq(5,30,5))]
hoc_tex
hoc_tex[,c('Method',seq(5,30,5))]
with(table_results_hoc, table_results_hoc[order(rank, rank),]) %>%
mutate_if(is.numeric, round, digits=3) %>%
mutate_at(c('5'),'test')
with(table_results_hoc, table_results_hoc[order(rank, rank),]) %>%
mutate_if(is.numeric, round, digits=3) %>%
mutate_at(.vars = c('5'),.funs = function() 'test')
with(table_results_hoc, table_results_hoc[order(rank, rank),]) %>%
mutate_if(is.numeric, round, digits=3) %>%
mutate_at(.vars = c(5),.funs = function() 'test')
vignette("colwise")
with(table_results_hoc, table_results_hoc[order(rank, rank),]) %>%
mutate(across(.cols=c(5:30),'test'))
with(table_results_hoc, table_results_hoc[order(rank, rank),]) %>%
mutate(across(.cols=c("5","10"),'test'))
with(table_results_hoc, table_results_hoc[order(rank, rank),]) %>%
mutate(across(starts_with("5"),
~ifelse(method == "se",paste0("(",.,")",.))))
with(table_results_hoc, table_results_hoc[order(rank, rank),]) %>%
mutate(across(starts_with("5"),
~ifelse(method == "se",paste0("(",.,")",.)),
.names = '{col}'))
with(table_results_hoc, table_results_hoc[order(rank, rank),]) %>%
mutate(across(starts_with("5"),
~ifelse(method == "se",paste0("(",.x,")",.x))))
with(table_results_hoc, table_results_hoc[order(rank, rank),]) %>%
mutate(across(starts_with("5"),
~ifelse(method == "se",paste0("(",.x,")"),.x)))
with(table_results_hoc, table_results_hoc[order(rank, rank),]) %>%
mutate_if(is.numeric, round, digits=3) %>%
mutate(across(`5`:`30`,
~ifelse(method == "se",paste0("(",.x,")"),.x)))
hoc_tex = with(table_results_hoc, table_results_hoc[order(rank, rank),]) %>%
mutate_if(is.numeric, round, digits=3) %>%
mutate(across(`5`:`30`,
~ifelse(method == "se",paste0("(",.x,")"),.x)))
hoc_tex["Method"] <- names
hoc_tex
write.table(hoc_tex[,c('Method',seq(5,30,5))],
file = "output/homoske_norma.tex", eol='\\\\',
sep='&',quote = F,row.names = F,
col.names = F,na="")
results_hoc = readRDS('results_hoc_pairs_t.RDS')
# Printing results_hoc
table_results_hoc = lapply(clusters, function(c){
tempo = do.call(rbind,lapply(estimators_wald,function(res){
dt = data.frame(method = c("mean","se"),
"wald"=rep(res,2),
row.names = NULL)
dt[[paste(c)]] <- c(mean(results_hoc[[paste(c)]][[res]][["rejection"]]),
sd(results_hoc[[paste(c)]][[res]][["rejection"]]))
return(dt)
}))
return(tempo)
}) %>% reduce(full_join, by=c("method","wald")) %>%
mutate(rank = factor(paste0(wald,method),
levels = paste0(rep(c('ols','crve','cr3',
'ols_Bt','crve_Bt','cr3_Bt',
'resi_Bt','wild_Bt'),each=2),
c('mean','se'))))
hoc_tex = with(table_results_hoc, table_results_hoc[order(rank, rank),]) %>%
mutate_if(is.numeric, round, digits=3) %>%
mutate(across(`5`:`30`,
~ifelse(method == "se",paste0("(",.x,")"),.x)))
hoc_tex["Method"] <- names
hoc_tex
results_hoc = readRDS('results_hoc_pairs_t.RDS')
# Printing results_hoc
table_results_hoc = lapply(clusters, function(c){
tempo = do.call(rbind,lapply(estimators_wald,function(res){
dt = data.frame(method = c("mean","se"),
"wald"=rep(res,2),
row.names = NULL)
dt[[paste(c)]] <- c(mean(results_hoc[[paste(c)]][[res]][["rejection"]]),
sd(results_hoc[[paste(c)]][[res]][["rejection"]]))
return(dt)
}))
return(tempo)
}) %>% reduce(full_join, by=c("method","wald")) %>%
mutate(rank = factor(paste0(wald,method),
levels = paste0(rep(c('ols','crve','cr3',
'ols_Bt','crve_Bt','cr3_Bt',
'resi_Bt','wild_Bt'),each=2),
c('mean','se'))))
hoc_tex = with(table_results_hoc, table_results_hoc[order(rank, rank),]) %>%
mutate_if(is.numeric, round, digits=3) %>%
mutate(across(`5`:`30`,
~ifelse(method == "se",paste0("(",.x,")"),.x)))
hoc_tex["Method"] <- names
hoc_tex
write.table(hoc_tex[,c('Method',seq(5,30,5))],
file = "output/homoske_norma.tex", eol='\\\\',
sep='&',quote = F,row.names = F,
col.names = F,na="")
mean(results_hoc[[paste(c)]][[res]][["rejection"]])
results_hoc[[paste(c)]][[res]][["rejection"]]
c
res
res = "ols"
results_hoc[[paste(c)]][[res]][["rejection"]]
mean(results_hoc[[paste(c)]][[res]][["rejection"]])
sd(results_hoc[[paste(c)]][[res]][["rejection"]])
length(results_hoc[[paste(c)]][[res]][["rejection"]])
# Printing results_hoc
table_results_hoc = lapply(clusters, function(c){
tempo = do.call(rbind,lapply(estimators_wald,function(res){
dt = data.frame(method = c("mean","se"),
"wald"=rep(res,2),
row.names = NULL)
rej = mean(results_hoc[[paste(c)]][[res]][["rejection"]])
R = length(results_hoc[[paste(c)]][[res]][["rejection"]])
dt[[paste(c)]] <- c(rej,
sqrt(rej*(1-rej)/(R-1)))
return(dt)
}))
return(tempo)
}) %>% reduce(full_join, by=c("method","wald")) %>%
mutate(rank = factor(paste0(wald,method),
levels = paste0(rep(c('ols','crve','cr3',
'ols_Bt','crve_Bt','cr3_Bt',
'resi_Bt','wild_Bt'),each=2),
c('mean','se'))))
hoc_tex = with(table_results_hoc, table_results_hoc[order(rank, rank),]) %>%
mutate_if(is.numeric, round, digits=3) %>%
mutate(across(`5`:`30`,
~ifelse(method == "se",paste0("(",.x,")"),.x)))
hoc_tex["Method"] <- names
hoc_tex
write.table(hoc_tex[,c('Method',seq(5,30,5))],
file = "output/homoske_norma.tex", eol='\\\\',
sep='&',quote = F,row.names = F,
col.names = F,na="")
# Random data generation process
data = dgp_homoskedastic(G=G,N_g=N_g)
# Estimation of regression:
reg = lm(y~x-1,data=data)
# Basic ols variance
wald_OLS = abs(waldOLS(reg, beta_null = beta_null))
results_hoc[[paste(G)]][["ols"]][["wald"]] = c(results_hoc[[paste(G)]][["ols"]][["wald"]],
wald_OLS)
results_hoc[[paste(G)]][["ols"]][["rejection"]] = c(results_hoc[[paste(G)]][["ols"]][["rejection"]],
as.integer(wald_OLS>thresh))
# CRVE variance estimator
wald_CRVE = abs(waldCR(data, beta_null = beta_null))
results_hoc[[paste(G)]][["crve"]][["wald"]] = c(results_hoc[[paste(G)]][["crve"]][["wald"]],
wald_CRVE)
results_hoc[[paste(G)]][["crve"]][["rejection"]] = c(results_hoc[[paste(G)]][["crve"]][["rejection"]],
as.integer(wald_CRVE>thresh))
# CR3 variance estimator
wald_CR3 = abs(waldOLS(coef_test(reg, df = data, vcov = vcovCR(reg, type = "CR3",cluster = data$g)),
beta_null = beta_null))
# Restricted beta and associated residuals
restrict = restricted_OLS(data)
data$ur = restrict[['residuals_r']]
waldOLS(reg, beta_null = beta_null)
# Residuals boostrap
beta_r = restrict[['beta_r']]
data_r = data.frame(x=data$x,
g=data$g,
y=beta_r*data$x+data_b$ur)
waldCR(data_r, beta_null = beta_null)
wald_CRVE
cv_boot_wild
# Wild variance:
boot_wild <- sort(boot_wild)
